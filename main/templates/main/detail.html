{% extends 'base.html' %}

{% block content %}
<p>제목: {{ post.title }}</p>
    <p>내용: {{ post.content }}</p>
    <p>시급: {{ post.payment }}</p>
    <p>지점: {{ post.workplace }}</p>
    <p>별점: {{ post.recommend }}</p>
    <p>직종: {{ post.work_type }}</p>

<p style="text-align: center; margin-top: 10%; font-weight: bold;">{{ total_likes }}명이 이 글을 추천했어요</p>

{% if request.user.is_authenticated %}
     <form action="{% url 'main:like_post' %}" method="post">
         {% csrf_token %}
         {% if is_liked %}
         <button type="submit" name="post_id" value="{{ post.id }}" class="btn btn-primary" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:5%">추천을 취소할래요!</button>
         {% else %}
         <button type="submit" name="post_id" value="{{ post.id }}" class="btn btn-primary" style="margin-left:auto;margin-right:auto;display:block;margin-bottom:5%">이 게시글을 추천할래요!</button>
         {% endif %}
     </form>
{% endif %}


    <h3>Comments</h3>
    <ul>
    {% for comment in post.comment_set.all %}
        <li>
            <div>{{ comment.updated_at}}</div>
            <div><strong>{{ comment.author}}</strong></div>
            <p>{{ comment.message }}</p>
            {% if comment.author == request.user %}
                <a href="{{ comment.get_edit_url }}">
                    수정
                </a>
                <a href="{{ comment.get_delete_url }}" class="text-danger">
                    삭제
                </a>
            {% endif %}
        </li>

        <div class="replied-comments container mt-2">
            <div class="form-group row">
                 <form method="post">
                     {% csrf_token %}
                     {{ comment_form.as_p }}
                     {% if request.user.is_authenticated %}
                        <input type="submit" value="Submit" class="btn btn-outline-success">
                     {% else %}
                        <input type="submit" value="Submit" class="btn btn-outline-success" disabled>
                     {% endif %}
                 </form>
            </div>
        </div>

    {% endfor %}
    </ul>

    <div class="panel-footer">
        <a href="{% url "main:comment_new" post.pk %}" class="btn btn-primary">댓글쓰기</a>
    </div>

    <a href="{% url "main:main" %}">메인으로 돌아가기</a>
{% endblock %}